# EZ-ERP ê²½ë¹„ê´€ë¦¬ ì‹œìŠ¤í…œ ë§Œë“¤ê¸° (2) - ì§€ì¶œ ë“±ë¡ê³¼ ìŠ¹ì¸/ë°˜ë ¤ ì²˜ë¦¬ API ë§Œë“¤ê¸°

ğŸ”— [ì›ë¬¸ ë§í¬](https://velog.io/@tjeudeud/EZ-ERP-%EA%B2%BD%EB%B9%84%EA%B4%80%EB%A6%AC-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%A7%8C%EB%93%A4%EA%B8%B0-2-%EC%A7%80%EC%B6%9C-%EB%93%B1%EB%A1%9D%EA%B3%BC-%EC%8A%B9%EC%9D%B8%EB%B0%98%EB%A0%A4-%EC%B2%98%EB%A6%AC-API-%EB%A7%8C%EB%93%A4%EA%B8%B0)

ğŸ—“ ì‘ì„±ì¼: 2025-06-11 22:56:48 KST

<p>ì´ë²ˆ ê¸€ì—ì„œëŠ” EZ-ERP í”„ë¡œì íŠ¸ì—ì„œ <code>ì§€ì¶œ(Expense)</code> ë„ë©”ì¸ì„ ì„¤ê³„í•˜ê³ ,
ì§€ì¶œ ë“±ë¡ ë° ìŠ¹ì¸/ë°˜ë ¤ ì²˜ë¦¬ APIë¥¼ ê°œë°œí•´ë³´ì!</p>
<hr />
<h2 id="âœ¨-ëª©í‘œ-ê¸°ëŠ¥">âœ¨ ëª©í‘œ ê¸°ëŠ¥</h2>
<ul>
<li>ì‚¬ìš©ìëŠ” ì§€ì¶œì„ ìš”ì²­í•  ìˆ˜ ìˆê³ </li>
<li>ê´€ë¦¬ìëŠ” í•´ë‹¹ ìš”ì²­ì„ ìŠ¹ì¸ ë˜ëŠ” ë°˜ë ¤í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<hr />
<h2 id="ğŸ—‚-ë””ë ‰í† ë¦¬-êµ¬ì¡°">ğŸ—‚ ë””ë ‰í† ë¦¬ êµ¬ì¡°</h2>
<p>ì´ì „ ê¸€ì˜ ë””ë ‰í† ë¦¬ì—ì„œ ì¶”ê°€ëœ ì½”ë“œë¥¼ í¬í•¨í•œ ë””ë ‰í† ë¦¬ êµ¬ì¡°ì´ë‹¤.</p>
<pre><code>com.ez.erp
â”œâ”€â”€ controller
â”‚   â””â”€â”€ ExpenseController.java
â”œâ”€â”€ domain
â”‚   â””â”€â”€ Expense.java
â”‚   â””â”€â”€ ExpenseStatus.java
â”œâ”€â”€ dto
â”‚   â””â”€â”€ ExpenseRequest.java
â”‚   â””â”€â”€ ExpenseStatusUpdateRequest.java
â”œâ”€â”€ repository
â”‚   â””â”€â”€ ExpenseRepository.java
â””â”€â”€ service
    â””â”€â”€ ExpenseService.java</code></pre><hr />
<h2 id="ğŸ§±-ë„ë©”ì¸-ì„¤ê³„-expense">ğŸ§± ë„ë©”ì¸ ì„¤ê³„: Expense</h2>
<table>
<thead>
<tr>
<th>í•„ë“œ</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>ì‹ë³„ì</td>
</tr>
<tr>
<td>title</td>
<td>ì§€ì¶œ ì œëª©</td>
</tr>
<tr>
<td>amount</td>
<td>ì§€ì¶œ ê¸ˆì•¡</td>
</tr>
<tr>
<td>requester</td>
<td>ìš”ì²­ì</td>
</tr>
<tr>
<td>requestedAt</td>
<td>ìš”ì²­ ì‹œê°„</td>
</tr>
<tr>
<td>status</td>
<td>PENDING, APPROVED, REJECTED</td>
</tr>
</tbody></table>
<blockquote>
<p>ì§€ì¶œ ìƒíƒœê°’ ì„¤ëª…:</p>
<ul>
<li><code>PENDING</code>: ì‚¬ìš©ìê°€ ì§€ì¶œì„ ìš”ì²­í•œ ì´ˆê¸° ìƒíƒœ</li>
<li><code>APPROVED</code>: ê´€ë¦¬ìê°€ ìŠ¹ì¸í•œ ìƒíƒœ</li>
<li><code>REJECTED</code>: ê´€ë¦¬ìê°€ ë°˜ë ¤í•œ ìƒíƒœ</li>
</ul>
</blockquote>
<hr />
<h2 id="ğŸ’¡-í•µì‹¬-êµ¬í˜„-í¬ì¸íŠ¸">ğŸ’¡ í•µì‹¬ êµ¬í˜„ í¬ì¸íŠ¸</h2>
<ul>
<li>ì§€ì¶œ ìƒíƒœëŠ” <code>Enum</code>ìœ¼ë¡œ ê´€ë¦¬ â†’ ì½”ë“œ ê°€ë…ì„±, ì•ˆì •ì„± í–¥ìƒ</li>
<li><code>@PrePersist</code>ë¡œ ìš”ì²­ ì‹œê°„ ìë™ ì²˜ë¦¬</li>
<li>REST API ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„</li>
<li>Swagger ì—°ë™ìœ¼ë¡œ ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥</li>
<li>ì˜ˆì™¸ ì²˜ë¦¬ëŠ” ê°„ë‹¨íˆ orElseThrow()ë¡œ ì²˜ë¦¬í–ˆìœ¼ë©°, ì¶”í›„ <code>@ControllerAdvice</code> ê¸°ë°˜ìœ¼ë¡œ í™•ì¥ ì˜ˆì •</li>
</ul>
<hr />
<h2 id="ğŸ§¾-ì£¼ìš”-ì½”ë“œ-êµ¬ì„±">ğŸ§¾ ì£¼ìš” ì½”ë“œ êµ¬ì„±</h2>
<h3 id="ğŸ“„-expensestatusjava">ğŸ“„ ExpenseStatus.java</h3>
<p>ì§€ì¶œ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” Enum í´ë˜ìŠ¤ì´ë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.domain;

public enum ExpenseStatus {
    PENDING, APPROVED, REJECTED
}</code></pre>
<h3 id="ğŸ“„-expensejava">ğŸ“„ Expense.java</h3>
<p>ì§€ì¶œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ì—”í‹°í‹°ì´ë‹¤. ìš”ì²­ ì‹œê°„ì€ ìë™ ì„¤ì •ë˜ë©°, ìƒíƒœëŠ” ê¸°ë³¸ì ìœ¼ë¡œ PENDINGìœ¼ë¡œ ì €ì¥ëœë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.domain;

import jakarta.persistence.*;
import lombok.*;

import java.time.LocalDateTime;

@Entity
@Getter @Setter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Expense {

    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String title;

    private int amount;

    private String requester;

    private LocalDateTime requestedAt;

    @Enumerated(EnumType.STRING)
    private ExpenseStatus status;

    @PrePersist
    public void onCreate() {
        this.requestedAt = LocalDateTime.now();
        this.status = ExpenseStatus.PENDING;
    }
}</code></pre>
<h3 id="ğŸ“„-expenserequestjava">ğŸ“„ ExpenseRequest.java</h3>
<p>ì§€ì¶œ ìš”ì²­ ì‹œ ì‚¬ìš©ë˜ëŠ” DTO í´ë˜ìŠ¤ì´ë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.dto;

import lombok.Getter;
import lombok.Setter;

@Getter @Setter
public class ExpenseRequest {
    private String title;
    private int amount;
    private String requester;
}</code></pre>
<h3 id="ğŸ“„-expensestatusupdaterequestjava">ğŸ“„ ExpenseStatusUpdateRequest.java</h3>
<p>ì§€ì¶œ ìƒíƒœ ë³€ê²½(PATCH) ìš”ì²­ì— ì‚¬ìš©ë˜ëŠ” DTO ì´ë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.dto;

import com.ez.erp.domain.ExpenseStatus;
import lombok.Getter;
import lombok.Setter;

@Getter @Setter
public class ExpenseStatusUpdateRequest {
    private ExpenseStatus status;
}</code></pre>
<h3 id="ğŸ“„-expenserepositoryjava">ğŸ“„ ExpenseRepository.java</h3>
<p>JPAë¥¼ í™œìš©í•´ DB ì—°ë™ì„ ìœ„í•œ Repository ì´ë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.repository;

import com.ez.erp.domain.Expense;
import org.springframework.data.jpa.repository.JpaRepository;

public interface ExpenseRepository extends JpaRepository&lt;Expense, Long&gt; {
}</code></pre>
<h3 id="ğŸ“„-expenseservicejava">ğŸ“„ ExpenseService.java</h3>
<p>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” Service ê³„ì¸µì´ë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.service;

import com.ez.erp.domain.Expense;
import com.ez.erp.domain.ExpenseStatus;
import com.ez.erp.dto.ExpenseRequest;
import com.ez.erp.repository.ExpenseRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
@RequiredArgsConstructor
public class ExpenseService {

    private final ExpenseRepository repository;

    public Expense createExpense(ExpenseRequest request) {
        Expense expense = Expense.builder()
                .title(request.getTitle())
                .amount(request.getAmount())
                .requester(request.getRequester())
                .build();
        return repository.save(expense);
    }

    public List&lt;Expense&gt; getAll() {
        return repository.findAll();
    }

    public Expense updateStatus(Long id, ExpenseStatus status) {
        Expense expense = repository.findById(id).orElseThrow();
        expense.setStatus(status);
        return repository.save(expense);
    }
}</code></pre>
<h3 id="ğŸ“„-expensecontrollerjava">ğŸ“„ ExpenseController.java</h3>
<p>REST APIë¥¼ ì œê³µí•˜ëŠ” Controller ì´ë‹¤.</p>
<pre><code class="language-java">package com.ez.erp.controller;

import com.ez.erp.domain.Expense;
import com.ez.erp.dto.ExpenseRequest;
import com.ez.erp.dto.ExpenseStatusUpdateRequest;
import com.ez.erp.service.ExpenseService;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping(&quot;/api/expenses&quot;)
@RequiredArgsConstructor
public class ExpenseController {

    private final ExpenseService expenseService;

    @PostMapping
    public Expense create(@RequestBody ExpenseRequest request) {
        return expenseService.createExpense(request);
    }

    @GetMapping
    public List&lt;Expense&gt; getAll() {
        return expenseService.getAll();
    }

    @PatchMapping(&quot;/{id}/status&quot;)
    public Expense updateStatus(@PathVariable Long id,
                                @RequestBody ExpenseStatusUpdateRequest request) {
        return expenseService.updateStatus(id, request.getStatus());
    }
}</code></pre>
<hr />
<h2 id="ğŸ”-swagger-ë¬¸ì„œ-í…ŒìŠ¤íŠ¸">ğŸ” Swagger ë¬¸ì„œ í…ŒìŠ¤íŠ¸</h2>
<p><code>http://localhost:8080/swagger-ui/index.html</code> ì— ì ‘ì†í•˜ì—¬ swagger ë¬¸ì„œë¥¼ í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<p><img alt="" src="https://velog.velcdn.com/images/tjeudeud/post/5165c8ce-edae-40d5-95c5-92971bee95b8/image.png" /></p>
<h4 id="swagger-íƒ€ì´í‹€ì„-ë°”ê¾¸ë ¤ë©´-swaggerconfigjava-íŒŒì¼ì—-ë‹¤ìŒê³¼-ê°™ì´-ì„¤ì •í•œë‹¤">Swagger íƒ€ì´í‹€ì„ ë°”ê¾¸ë ¤ë©´ SwaggerConfig.java íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•œë‹¤:</h4>
<pre><code class="language-java">@Configuration
public class SwaggerConfig {
    @Bean
    public OpenAPI ezErpOpenAPI() {
        return new OpenAPI()
            .info(new Info()
                .title(&quot;EZ-ERP API ë¬¸ì„œ&quot;)
                .description(&quot;ì§€ì¶œ/ìŠ¹ì¸ ê¸°ëŠ¥ì´ í¬í•¨ëœ ë°±ì—”ë“œ API&quot;)
                .version(&quot;v1.0.0&quot;));
    }
}</code></pre>
<hr />
<h2 id="ğŸ”§-postmanìœ¼ë¡œ-api-í…ŒìŠ¤íŠ¸">ğŸ”§ Postmanìœ¼ë¡œ API í…ŒìŠ¤íŠ¸</h2>
<p><strong>POST /api/expenses</strong></p>
<pre><code class="language-json">{
  &quot;title&quot;: &quot;ì¶œì¥ êµí†µë¹„&quot;,
  &quot;amount&quot;: 30000,
  &quot;requester&quot;: &quot;kim@ez.com&quot;
}</code></pre>
<br />

<h4 id="ì‹¤í–‰-ê²°ê³¼">ì‹¤í–‰ ê²°ê³¼</h4>
<p><img alt="" src="https://velog.velcdn.com/images/tjeudeud/post/82945ddd-a126-414c-a971-fcd2134f79e9/image.png" /></p>
<p>*<em>200 OK *</em> ê°€ ì„±ê³µì ìœ¼ë¡œ ëœ¨ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<hr />
<p><strong>PATCH /api/expenses/1/status</strong></p>
<pre><code class="language-json">{
  &quot;status&quot;: &quot;APPROVED&quot;
}</code></pre>
<p>ì‹¤í–‰ê²°ê³¼
<img alt="" src="https://velog.velcdn.com/images/tjeudeud/post/98e7349e-70cf-4634-9928-1909bb42161e/image.png" /></p>
<p><code>Patch</code> ë„ ì„±ê³µì ìœ¼ë¡œ 200 OK ê°€ ëœ¨ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<hr />
<h3 id="ğŸ“‹-ê°œë°œ-í™˜ê²½-ìš”ì•½">ğŸ“‹ ê°œë°œ í™˜ê²½ ìš”ì•½</h3>
<table>
<thead>
<tr>
<th>í•­ëª©</th>
<th>ë‚´ìš©</th>
</tr>
</thead>
<tbody><tr>
<td>ì–¸ì–´</td>
<td>Java 21</td>
</tr>
<tr>
<td>í”„ë ˆì„ì›Œí¬</td>
<td>Spring Boot 3.5.0</td>
</tr>
<tr>
<td>DB</td>
<td>H2 Database</td>
</tr>
<tr>
<td>API ë¬¸ì„œ</td>
<td>Swagger (localhost:8080/swagger-ui)</td>
</tr>
</tbody></table>
<hr />
<h3 id="ğŸ”š-ë‹¤ìŒ-ëª©í‘œ">ğŸ”š ë‹¤ìŒ ëª©í‘œ</h3>
<ul>
<li>ì›”ë³„ ì§€ì¶œ í†µê³„ API ë§Œë“¤ê¸°</li>
<li>ìŠ¹ì¸ëœ ì§€ì¶œë§Œ í•©ì‚°í•´ì„œ ì›” ê¸°ì¤€ í†µê³„ ë°˜í™˜</li>
</ul>